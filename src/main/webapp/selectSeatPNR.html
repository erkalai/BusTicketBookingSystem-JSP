<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>

 <%
if(session.getAttribute("sessionId")==null){
	response.sendRedirect("index.jsp");
}
if(request.getParameter("logout")!=null){
	session.removeAttribute("sessionId");
	response.sendRedirect("index.jsp");
}
%>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bus Seat Layout</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./assets/css/seatLayout.css">
</head>
<body>
<%@include file="./loginHeader.jsp" %>
<div class="container ">
    <div class="row">
        <!-- Seat Layout Column -->
        <div class="col-lg-3 mt-2 p-2 seatLayout">
            <div class="driver-seat-row me-2">
                <div class="driver-seat-box" data-seat="S1">
                    <label for="seat1">Driver Seat</label>
                </div>
            </div>
            <div class="seat-row">
                <div class="seat-box" data-seat="S1">
                    <input type="checkbox" id="seat1"> <label for="seat1">S1</label>
                </div>
                <div class="seat-box" data-seat="S2">
                    <input type="checkbox" id="seat2"> <label for="seat2">S2</label>
                </div>
                <div class="seat-box ms-5" data-seat="S3">
                    <input type="checkbox" id="seat3"> <label for="seat3">S3</label>
                </div>
                <div class="seat-box" data-seat="S4">
                    <input type="checkbox" id="seat4"> <label for="seat4">S4</label>
                </div>
            </div>
            <div class="seat-row">
                <div class="seat-box" data-seat="S5">
                    <input type="checkbox" id="seat5"> <label for="seat5">S5</label>
                </div>
                <div class="seat-box" data-seat="S6">
                    <input type="checkbox" id="seat6"> <label for="seat6">S6</label>
                </div>
                <div class="seat-box ms-5" data-seat="S7">
                    <input type="checkbox" id="seat7"> <label for="seat7">S7</label>
                </div>
                <div class="seat-box" data-seat="S8">
                    <input type="checkbox" id="seat8"> <label for="seat8">S8</label>
                </div>
            </div>
            <div class="seat-row">
                <div class="seat-box" data-seat="S9">
                    <input type="checkbox" id="seat9"> <label for="seat9">S9</label>
                </div>
                <div class="seat-box" data-seat="S10">
                    <input type="checkbox" id="seat10"> <label for="seat10">S10</label>
                </div>
                <div class="seat-box ms-5" data-seat="S11">
                    <input type="checkbox" id="seat11"> <label for="seat11">S11</label>
                </div>
                <div class="seat-box" data-seat="S12">
                    <input type="checkbox" id="seat12"> <label for="seat12">S12</label>
                </div>
            </div>
            <div class="seat-row">
                <div class="seat-box" data-seat="S13">
                    <input type="checkbox" id="seat13"> <label for="seat13">S13</label>
                </div>
                <div class="seat-box" data-seat="S14">
                    <input type="checkbox" id="seat14"> <label for="seat14">S14</label>
                </div>
                <div class="seat-box ms-5" data-seat="S15">
                    <input type="checkbox" id="seat15"> <label for="seat15">S15</label>
                </div>
                <div class="seat-box" data-seat="S16">
                    <input type="checkbox" id="seat16"> <label for="seat16">S16</label>
                </div>
            </div>
            <div class="seat-row">
                <div class="seat-box" data-seat="S17">
                    <input type="checkbox" id="seat17"> <label for="seat17">S17</label>
                </div>
                <div class="seat-box" data-seat="S18">
                    <input type="checkbox" id="seat18"> <label for="seat18">S18</label>
                </div>
                <div class="seat-box ms-5" data-seat="S19">
                    <input type="checkbox" id="seat19"> <label for="seat19">S19</label>
                </div>
                <div class="seat-box" data-seat="S20">
                    <input type="checkbox" id="seat20"> <label for="seat20">S20</label>
                </div>
            </div>
            <div class="seat-row">
                <div class="seat-box" data-seat="S21">
                    <input type="checkbox" id="seat21"> <label for="seat21">S21</label>
                </div>
                <div class="seat-box" data-seat="S22">
                    <input type="checkbox" id="seat22"> <label for="seat22">S22</label>
                </div>
                <div class="seat-box ms-5" data-seat="S23">
                    <input type="checkbox" id="seat23"> <label for="seat23">S23</label>
                </div>
                <div class="seat-box" data-seat="S24">
                    <input type="checkbox" id="seat24"> <label for="seat24">S24</label>
                </div>
            </div>
            <div class="seat-row">
                <div class="seat-box" data-seat="S25">
                    <input type="checkbox" id="seat25"> <label for="seat25">S25</label>
                </div>
                <div class="seat-box" data-seat="S26">
                    <input type="checkbox" id="seat26"> <label for="seat26">S26</label>
                </div>
                <div class="seat-box ms-5" data-seat="S27">
                    <input type="checkbox" id="seat27"> <label for="seat27">S27</label>
                </div>
                <div class="seat-box" data-seat="S28">
                    <input type="checkbox" id="seat28"> <label for="seat28">S28</label>
                </div>
            </div>
            <div class="seat-row">
                <div class="seat-box" data-seat="S29">
                    <input type="checkbox" id="seat29"> <label for="seat29">S29</label>
                </div>
                <div class="seat-box" data-seat="S30">
                    <input type="checkbox" id="seat30"> <label for="seat30">S30</label>
                </div>
                <div class="seat-box ms-5" data-seat="S31">
                    <input type="checkbox" id="seat31"> <label for="seat31">S31</label>
                </div>
                <div class="seat-box" data-seat="S32">
                    <input type="checkbox" id="seat32"> <label for="seat32">S32</label>
                </div>
            </div>
            <div class="seat-row">
                <div class="seat-box" data-seat="S33">
                    <input type="checkbox" id="seat33"> <label for="seat33">S33</label>
                </div>
                <div class="seat-box" data-seat="S34">
                    <input type="checkbox" id="seat34"> <label for="seat34">S34</label>
                </div>
                <div class="seat-box ms-5" data-seat="S35">
                    <input type="checkbox" id="seat35"> <label for="seat35">S35</label>
                </div>
                <div class="seat-box" data-seat="S36">
                    <input type="checkbox" id="seat36"> <label for="seat36">S36</label>
                </div>
            </div>
            <div class="seat-row">
                <div class="seat-box" data-seat="S37">
                    <input type="checkbox" id="seat37"> <label for="seat37">S37</label>
                </div>
                <div class="seat-box" data-seat="S38">
                    <input type="checkbox" id="seat38"> <label for="seat38">S38</label>
                </div>
                <div class="seat-box ms-5" data-seat="S39">
                    <input type="checkbox" id="seat39"> <label for="seat39">S39</label>
                </div>
                <div class="seat-box" data-seat="S40">
                    <input type="checkbox" id="seat40"> <label for="seat40">S40</label>
                </div>
            </div>
        </div>

        <!-- Passenger Form Column -->
        <div class="col-lg-9 mt-2 p-2">
            <div class="row">
                <div class="col">
                    <div class="titleText fw-bold text-center text-primary fs-4 text-decoration-underline">Journey Details</div>
                </div>
            </div>
            <div class="row">
                <div class="fromto text-center">${bus.startPlace} <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" font-weight: bold; fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"/>
                  </svg> 
                  ${bus.endPlace}</div>
            </div>
            <div class="row ">
                <div class="col">${bus.departureTime}</div>
                <div class="col"></div>
                <div class="col"></div>
                <div class="col"></div>
                <div class="col"></div>
                <div class="col"></div>
                <div class="col">${bus.busName}</div>
            </div>
            <!-- Selected Seats List -->
            <div class="passenger-form d-flex">
                <h5>Selected Seats :</h5>
                <ul id="selectedSeatsList"></ul>
            </div>
            <form id="passengerForm">
                <!-- Full Name -->
                <div class="mb-3">
                    <label for="fullName" class="form-label">Full Name</label>
                    <input type="text" class="form-control" id="fullName" placeholder="Enter full name" required>
                </div>

                <!-- Identity -->
                <div class="row">
                    <div class="col mb-3">
                        <label for="identity" class="form-label">Identity</label><select class="form-control" id="identity" required>
                            <option value="" disabled selected>Select Identity Type</option>
                            <option value="Aadhar">Aadhar ID</option>
                            <option value="Voter">Voter ID</option>
                            <option value="Driving">Driving Licence</option>
                            <option value="Passport">Passport</option>
                            <option value="Other">Other Goverment ID</option>
                        </select>
                    </div>

                    <!-- ID Number -->
                    <div class="col mb-3">
                        <label for="idNumber" class="form-label">ID Number</label>
                        <input type="text" class="form-control" id="idNumber" placeholder="Enter your ID number" required>
                    </div>
                </div>

                <!-- Age -->
                <div class="row">
                    <div class="col mb-3">
                        <label for="age" class="form-label">Age</label>
                        <input type="number" class="form-control" id="age" placeholder="Enter your age" required>
                    </div>

                    <!-- Gender -->
                    <div class=" col mb-3">
                        <label for="gender" class="form-label">Gender</label>
                        <select class="form-control" id="gender" required>
                            <option value="" disabled selected>Select gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Transgender">Transgender</option>
                        </select>
                    </div>
                </div>

               <div class="row">
                <div class="col">
                        <!-- Mobile Number -->
                    <div class="mb-3">
                        <label for="mobile" class="form-label">Mobile Number</label>
                        <input type="tel" class="form-control" id="mobile" placeholder="Enter mobile number" required>
                    </div>
                </div>
                <div class="col">
                    <!-- Email -->
                <div class="mb-3">
                    <label for="email" class="form-label">Email</label>
                    <input type="email" class="form-control" id="email" placeholder="Enter email" required>
                </div>
                </div>
               </div>

                <!-- Submit Button -->
                <button type="submit" class="btn btn-primary">Submit</button>
                <a href="" button  class="btn btn-danger">Cancel</a>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const seatBoxes = document.querySelectorAll('.seat-box');
        const selectedSeatsList = document.getElementById('selectedSeatsList');

        // Array to store selected seats
        let selectedSeats = [];

        // Function to update the selected seats list
        function updateSeatList() {
            selectedSeatsList.innerHTML = ''; // Clear the list
            selectedSeats.forEach(seat => {
                const listItem = document.createElement('li');
                listItem.textContent = seat;
                selectedSeatsList.appendChild(listItem);
            });
        }

        // Handle seat click
        seatBoxes.forEach(seatBox => {
            const checkbox = seatBox.querySelector('input[type="checkbox"]');
            const seatId = seatBox.getAttribute('data-seat');

            // If the checkbox is clicked directly
            checkbox.addEventListener('change', function () {
                if (checkbox.checked) {
                    // Add the seat to the selected seats array if checked
                    if (!selectedSeats.includes(seatId)) {
                        selectedSeats.push(seatId);
                    }
                } else {
                    // Remove the seat from the selected seats array if unchecked
                    const index = selectedSeats.indexOf(seatId);
                    if (index > -1) {
                        selectedSeats.splice(index, 1);
                    }
                }
                updateSeatList();
                seatBox.classList.toggle('selected', checkbox.checked); // Toggle the style on the seat box
            });

            // Handle click on the seat box to toggle checkbox state
            seatBox.addEventListener('click', function () {
                checkbox.checked = !checkbox.checked; // Toggle checkbox state
                if (checkbox.checked) {
                    // Add seat to the list if checked
                    if (!selectedSeats.includes(seatId)) {
                        selectedSeats.push(seatId);
                    }
                } else {
                    // Remove seat from the list if unchecked
                    const index = selectedSeats.indexOf(seatId);
                    if (index > -1) {
                        selectedSeats.splice(index, 1);
                    }
                }
                updateSeatList();
                seatBox.classList.toggle('selected', checkbox.checked); // Toggle the style on the seat box
            });
        });
    });
</script>

</body>
</html>
